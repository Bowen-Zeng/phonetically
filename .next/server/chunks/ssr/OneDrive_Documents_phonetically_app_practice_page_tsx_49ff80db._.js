module.exports=[96698,a=>{"use strict";var b=a.i(84853),c=a.i(64257),d=a.i(6360),e=a.i(38002),f=a.i(71316),g=a.i(30637);let h=(0,g.default)("mic",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]]),i=(0,g.default)("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),j=(0,g.default)("settings-2",[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),k=(0,g.default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),l=["cat","hat","bat","mat","sat","red","bed","led","sit","hit"],m={TH:["think","thumb","the","that","this"],R:["red","run","car","rock","rain"],S:["sun","sit","bus","sat","see"],SH:["ship","shoe","fish","wash","shop"],L:["lip","look","ball","light","love"],"Short A":["cat","hat","bat","mat","sat"],"Short I":["sit","hit","pig","big","win"],"Short E":["red","bed","led","pet","net"],F:["fun","fish","off","four","fine"],V:["van","vine","love","have","very"]},n={...Object.fromEntries(Object.entries(m).flatMap(([a,b])=>b.map(b=>[b,a]))),cat:"Short A",hat:"Short A",bat:"Short A",mat:"Short A",sat:"Short A",red:"Short E",bed:"Short E",led:"Short E",sit:"Short I",hit:"Short I"},o={cat:"/kæt/",hat:"/hæt/",bat:"/bæt/",mat:"/mæt/",sat:"/sæt/",red:"/rɛd/",bed:"/bɛd/",led:"/lɛd/",pet:"/pɛt/",net:"/nɛt/",sit:"/sɪt/",hit:"/hɪt/",pig:"/pɪɡ/",big:"/bɪɡ/",win:"/wɪn/",think:"/θɪŋk/",thumb:"/θʌm/",the:"/ðə/",that:"/ðæt/",this:"/ðɪs/",run:"/rʌn/",car:"/kɑr/",rock:"/rɑk/",rain:"/reɪn/",sun:"/sʌn/",bus:"/bʌs/",see:"/si/",ship:"/ʃɪp/",shoe:"/ʃu/",fish:"/fɪʃ/",wash:"/wɑʃ/",shop:"/ʃɑp/",lip:"/lɪp/",look:"/lʊk/",ball:"/bɔl/",light:"/laɪt/",love:"/lʌv/",fun:"/fʌn/",off:"/ɔf/",four:"/fɔr/",fine:"/faɪn/",van:"/væn/",vine:"/vaɪn/",have:"/hæv/",very:"/ˈvɛri/"};function p(a){return o[a.toLowerCase()]||""}function q(){let a,g,o=(0,d.useRouter)(),q=(0,d.useSearchParams)().get("sound"),r=!!(q&&m[q]),[s,t]=(0,c.useState)(r?"word":"name"),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(r&&q?m[q]:l),[y,z]=(0,c.useState)(r?q:null),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)(0),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(null),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)(0),[Q,R]=(0,c.useState)(null),[S,T]=(0,c.useState)("idle"),[U,V]=(0,c.useState)(null),[W,X]=(0,c.useState)(0),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)([]),[aa,ab]=(0,c.useState)("Idle"),[ac,ad]=(0,c.useState)(null),[ae,af]=(0,c.useState)(null),[ag,ah]=(0,c.useState)([]),[ai,aj]=(0,c.useState)("normal"),[ak,al]=(0,c.useState)(null),[am,an]=(0,c.useState)(!1),ao=(0,c.useRef)(null),ap=(0,c.useRef)(null),aq=(0,c.useRef)(null);(0,c.useRef)(null),(0,c.useRef)(0);let ar=(0,c.useRef)(null),as=(0,c.useRef)(null),at=(0,c.useCallback)(a=>{let b=new Date().toLocaleTimeString("en-US",{hour12:!1});_(c=>[...c.slice(-9),{t:b,event:a}])},[]);(0,c.useEffect)(()=>{as.current?.scrollIntoView({behavior:"smooth"})},[A]);let au=(0,c.useCallback)(async()=>{},[]),av=(0,c.useCallback)(async()=>{},[]),aw=(0,c.useCallback)(()=>{aq.current&&cancelAnimationFrame(aq.current),ao.current?.getTracks().forEach(a=>a.stop()),ao.current=null,ap.current=null,Z(!1),X(0)},[]);(0,c.useEffect)(()=>()=>aw(),[aw]),(0,c.useEffect)(()=>{try{localStorage.setItem("phona-diagnostics-open",String(am))}catch{}},[am]),(0,c.useEffect)(()=>{},[]),(0,c.useEffect)(()=>{},[]),(0,c.useEffect)(()=>{},[]);let ax=(0,c.useCallback)(async a=>{B(b=>[...b,{from:"phona",text:a}]);try{let b=await fetch("/api/speak",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:a})});if(b.ok){let a=await b.blob(),c=URL.createObjectURL(a),d=new Audio(c);await new Promise((a,b)=>{d.onended=()=>{URL.revokeObjectURL(c),a()},d.onerror=()=>b(Error("Playback failed")),d.play()})}}catch{}},[]),ay=(0,c.useRef)(!1);(0,c.useEffect)(()=>{if(r&&!ay.current){ay.current=!0,P(0),D(0);try{let a=localStorage.getItem("phona-user-name");a&&v(a)}catch{}(async()=>{try{let a=await fetch("/api/sessions/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:aG(),mode:"practice_words"})}),b=await a.json();b.sessionId&&N(b.sessionId)}catch(a){console.error("Session start failed",a)}})()}},[r]);let[az,aA]=(0,c.useState)(!0),[aB,aC]=(0,c.useState)(!1),aD=(0,c.useRef)(!1);(0,c.useEffect)(()=>{if(aD.current)return;if(r){aD.current=!0,aA(!1);return}let a=setTimeout(()=>{aD.current=!0,aA(!1),aC(!0),ax("Hi, I'm Phona your phonetic speech assistant. It's nice to meet you! Before we get started what's your name?")},600);return()=>clearTimeout(a)},[]);let aE=async()=>{let a=u.trim()||"there";v(a),aA(!1),aC(!1);try{localStorage.setItem("phona-user-name",a)}catch{}B(b=>[...b,{from:"user",text:a},{from:"phona",text:"Okay! Are you ready to start a tutorial?"}]),ax("Okay! Are you ready to start a tutorial?"),t("mode")},aF=async()=>{B(a=>[...a,{from:"user",text:"Continue with tutorial"}]),x(l),z(null),await aH(),ax(`Nice to meet you ${u||"there"}! Let's start practicing some phonetics.`),t("word")},aG=()=>"default",aH=async()=>{try{let a=await fetch("/api/sessions/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:aG(),mode:"practice_words"})}),b=await a.json();b.sessionId&&(N(b.sessionId),P(0))}catch(a){console.error("Session start failed",a)}},aI=(0,c.useCallback)(async(a,b)=>{let c=await fetch("/api/practice/score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({word:a,transcript:b,sessionId:M||void 0,userId:aG(),sound:n[a]||null,phonetics:p(a)||null})}),d=await c.json(),e=d.attemptCount??O+1;if(P(e),J({accuracy:d.accuracy,syllables:d.syllables||[]}),e>=3){M&&await fetch("/api/sessions/end",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:M})}),await ax(`Great job, ${u||"there"}! You completed the tutorial.`),t("complete");return}if(d.accuracy>=90)L("✅ Nice!"),await ax("Nice!"),J(null),F(""),C<w.length-1?(D(a=>a+1),setTimeout(()=>L(null),1200)):(L("You've completed all the words! Great job."),M&&await fetch("/api/sessions/end",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:M})}));else if(d.tooNoisy){let a="It seems too noisy here. Please try moving somewhere quieter.";L(a),af(a),await ax(a)}else{let a=(d.syllables||[]).join(" - "),b=`Almost! Let's try it in syllables: ${a}`;L(b),await ax(b)}},[M,C,ax,O,u,o,y]),aJ=(0,c.useCallback)(async()=>{},[C,w,Q,aI,at]),aK=(0,c.useCallback)(a=>{},[ai]);(0,c.useEffect)(()=>{},[]);let aL=w[C];return(0,b.jsx)("div",{className:"app-container",children:(0,b.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,b.jsxs)("div",{className:"phona-header",children:[(0,b.jsx)(e.default,{href:"/",className:"phona-logo-link","aria-label":"Back to Home",children:(0,b.jsx)(f.default,{src:"/phoneticallylogo.png",alt:"Phonetically",width:96,height:96,className:"phona-header-logo",priority:!0})}),(0,b.jsx)("div",{})]}),(0,b.jsx)("div",{className:"app-content-scroll phona-practice-fixed",children:(0,b.jsx)("div",{className:"content-wrapper max-w-2xl mx-auto w-full p-8",children:(0,b.jsxs)("div",{className:"word"===s||"complete"===s?"phona-fresh-container":"phona-chat",children:["word"!==s&&"complete"!==s&&A.map((a,c)=>(0,b.jsxs)("div",{className:`phona-message-wrap ${"phona"===a.from?"phona-message-wrap-bot":"phona-message-wrap-user"}`,children:["phona"===a.from&&(0,b.jsx)("div",{className:"phona-avatar","aria-hidden":!0,children:(0,b.jsx)(f.default,{src:"/phoneticallylogo.png",alt:"",width:36,height:36})}),(0,b.jsx)("div",{className:`phona-message phona-message-enter ${"phona"===a.from?"phona-message-bot":"phona-message-user"}`,children:a.text})]},c)),"name"===s&&az&&(0,b.jsxs)("div",{className:"phona-message-wrap phona-message-wrap-bot",children:[(0,b.jsx)("div",{className:"phona-avatar","aria-hidden":!0,children:(0,b.jsx)(f.default,{src:"/phoneticallylogo.png",alt:"",width:36,height:36})}),(0,b.jsxs)("div",{className:"phona-typing-indicator",children:[(0,b.jsx)("span",{className:"phona-typing-dot"}),(0,b.jsx)("span",{className:"phona-typing-dot"}),(0,b.jsx)("span",{className:"phona-typing-dot"})]})]}),"name"===s&&aB&&(0,b.jsxs)("div",{className:"phona-input-section",children:[(0,b.jsxs)("div",{className:"phona-input-row",children:[(0,b.jsx)("input",{type:"text",placeholder:"Your name",className:"glass-input phona-input",value:u,onChange:a=>v(a.target.value),onKeyDown:a=>"Enter"===a.key&&aE()}),(0,b.jsx)("button",{type:"button",onClick:aE,className:"glass-button phona-send","aria-label":"Send",children:"Send"})]}),(0,b.jsx)("p",{className:"phona-input-hint",children:"Enter your name to get started"})]}),"mode"===s&&(0,b.jsxs)("div",{className:"phona-tutorial-options",children:[(0,b.jsx)("button",{type:"button",onClick:aF,className:"glass-button phona-option-btn phona-option-primary",children:"Continue with tutorial"}),(0,b.jsx)("button",{type:"button",onClick:()=>{B(a=>[...a,{from:"user",text:"Skip"}]),o.push("/dashboard")},className:"glass-button phona-option-btn phona-option-secondary",children:"Skip"})]}),"complete"===s&&(0,b.jsxs)("div",{className:"phona-complete-view",children:[(0,b.jsxs)("div",{className:"phona-complete-message",children:[(0,b.jsxs)("h2",{className:"phona-complete-title",children:["Great job, ",u||"there","!"]}),(0,b.jsx)("p",{className:"phona-complete-subtitle",children:"You completed the voice tutorial. Head to your dashboard to pick sounds and keep practicing."})]}),(0,b.jsx)("button",{type:"button",onClick:()=>o.push("/dashboard"),className:"glass-button phona-continue-btn",children:"Continue to Dashboard"})]}),"word"===s&&aL&&(0,b.jsxs)("div",{className:"phona-fresh-view",children:[(0,b.jsxs)("div",{className:"phona-target-row",children:[(0,b.jsxs)("div",{className:"phona-target-word-wrap",children:[(0,b.jsx)("div",{className:"phona-target-word-center",children:aL}),p(aL)&&(0,b.jsx)("div",{className:"phona-target-phonetics",children:p(aL)})]}),(0,b.jsxs)("div",{className:"phona-play-section",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>aK(aL),className:"glass-button phona-play-btn",title:"Hear the word",children:[(0,b.jsx)(i,{size:24}),"Play"]}),(0,b.jsxs)("div",{className:"phona-rate-toggle",children:[(0,b.jsx)("button",{type:"button",onClick:()=>aj("normal"),className:`phona-rate-btn ${"normal"===ai?"phona-rate-active":""}`,children:"Normal"}),(0,b.jsx)("button",{type:"button",onClick:()=>aj("slow"),className:`phona-rate-btn ${"slow"===ai?"phona-rate-active":""}`,children:"Slow"})]})]})]}),ak&&(0,b.jsx)("div",{className:"phona-tts-fallback",children:ak}),(a="browser-unsupported"===S?"Speech recognition is not supported in this browser. Please use Chrome or Edge.":"mic-blocked"===S?"Microphone access is blocked. Please enable it in browser settings.":"no-speech"===S?"No speech detected":"Speech detected"===aa?"Speech detected":"listening"===S?"Listening...":"Error"===aa?"Error":"Idle",g="Speech detected"===aa?"success":"listening"===S?"listening":"no-speech"===S||"browser-unsupported"===S||"mic-blocked"===S||"Error"===aa?"error":"idle",(0,b.jsxs)("div",{className:"phona-status-wrap",role:"status","aria-live":"polite",children:[(0,b.jsx)("div",{className:`phona-status phona-status-${g}`,children:a}),K&&(0,b.jsx)("div",{className:"phona-feedback",children:K})]})),!1!==Q&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"phona-speak-tip",children:"Tip: Tap Speak and start talking right away."}),(0,b.jsxs)("button",{type:"button",onClick:G?()=>{ar.current&&(ar.current.stop(),ar.current=null)}:aJ,className:`phona-mic-large ${G?"phona-mic-listening":""}`,children:[(0,b.jsx)(h,{size:36,strokeWidth:2}),(0,b.jsx)("span",{className:"phona-mic-label",children:"Speak"})]})]}),I&&I.accuracy<90&&(0,b.jsx)("button",{type:"button",onClick:()=>{J(null),L(null),F(""),T("idle"),aJ()},className:"glass-button phona-retry",children:"Try again"})]}),"word"===s&&(0,b.jsxs)("div",{className:"phona-diagnostics-float",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>an(a=>!a),className:`phona-diagnostics-toggle ${am?"phona-diagnostics-toggle-open":""}`,children:[(0,b.jsx)(j,{size:18}),"Diagnostics"]}),(0,b.jsxs)("div",{className:`phona-diagnostics-panel ${am?"phona-diagnostics-panel-open":""}`,children:[(0,b.jsxs)("div",{className:"phona-diagnostics-header-row",children:[(0,b.jsx)("span",{className:"phona-diagnostics-header",children:"Speech Diagnostics"}),(0,b.jsx)("button",{type:"button",onClick:()=>an(!1),className:"phona-diagnostics-close","aria-label":"Close",children:(0,b.jsx)(k,{size:18})})]}),(0,b.jsxs)("div",{className:"phona-diagnostics-body",children:[(0,b.jsxs)("div",{className:"phona-diagnostic-row",children:[(0,b.jsx)("button",{type:"button",onClick:au,className:"glass-button phona-diagnostic-btn",children:"Mic Test"}),U&&(0,b.jsx)("span",{className:"phona-diagnostic-result",children:U})]}),(0,b.jsxs)("div",{className:"phona-diagnostic-row",children:[(0,b.jsx)("button",{type:"button",onClick:Y?aw:av,className:"glass-button phona-diagnostic-btn",children:Y?"Stop Meter":"Input Level Meter"}),Y&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"phona-level-bar",children:(0,b.jsx)("div",{className:"phona-level-fill",style:{width:`${Math.min(100,2*W)}%`}})}),(0,b.jsx)("span",{className:"phona-level-value",children:W}),W<5&&(0,b.jsx)("span",{className:"phona-diagnostic-warn",children:"Mic not receiving audio—check input device."})]})]}),(0,b.jsxs)("div",{className:"phona-debug-panel",children:[(0,b.jsxs)("div",{className:"phona-debug-row",children:[(0,b.jsx)("span",{className:"phona-debug-label",children:"Status:"}),(0,b.jsx)("span",{className:"phona-debug-value",children:aa})]}),ac&&(0,b.jsxs)("div",{className:"phona-debug-row",children:[(0,b.jsx)("span",{className:"phona-debug-label",children:"Last issue:"}),(0,b.jsx)("span",{className:"phona-debug-value phona-debug-error",children:ac})]}),ae&&(0,b.jsx)("div",{className:"phona-targeted-msg",children:ae}),(0,b.jsx)("div",{className:"phona-debug-events",children:$.slice(-10).map((a,c)=>(0,b.jsxs)("div",{className:"phona-debug-event",children:["[",a.t,"] ",a.event]},c))})]}),(0,b.jsxs)("div",{className:"phona-device-guidance",children:[(0,b.jsx)("strong",{children:"Mic selection:"})," Edge address bar → lock icon → Site permissions → Microphone. Or Windows Settings → Sound → Input device.",ag.length>0&&(0,b.jsxs)("div",{className:"phona-device-list",children:["Detected inputs: ",ag.join(", ")||"none"]})]}),(0,b.jsxs)("div",{className:"phona-interpret-note",children:[(0,b.jsx)("strong",{children:"How to interpret:"}),(0,b.jsxs)("ul",{className:"phona-interpret-list",children:[(0,b.jsx)("li",{children:"Mic Test fails → microphone permissions or Windows privacy settings"}),(0,b.jsx)("li",{children:"Meter moves but no speech events → SpeechRecognition service/network may be blocked"}),(0,b.jsx)("li",{children:"Meter flat → wrong input device or muted mic"})]})]})]})]})]}),(0,b.jsx)("div",{ref:as})]})})})]})})}function r(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsxs)("div",{className:"app-container",children:[(0,b.jsxs)("div",{className:"phona-header",children:[(0,b.jsx)(e.default,{href:"/",className:"phona-logo-link","aria-label":"Back to Home",children:(0,b.jsx)(f.default,{src:"/phoneticallylogo.png",alt:"Phonetically",width:96,height:96,className:"phona-header-logo",priority:!0})}),(0,b.jsx)("div",{})]}),(0,b.jsx)("div",{className:"app-content-scroll phona-practice-fixed",children:(0,b.jsx)("div",{className:"content-wrapper max-w-2xl mx-auto w-full p-8",children:(0,b.jsx)("p",{className:"text-white/60",children:"Loading..."})})})]}),children:(0,b.jsx)(q,{})})}a.s(["default",()=>r],96698)}];

//# sourceMappingURL=OneDrive_Documents_phonetically_app_practice_page_tsx_49ff80db._.js.map