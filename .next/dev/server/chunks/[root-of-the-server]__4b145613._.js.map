{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/10099/OneDrive/Documents/phonetically/lib/mongodb.ts"],"sourcesContent":["/**\r\n * MongoDB connection - uses MONGODB_URI env variable\r\n * Add to .env.local: MONGODB_URI=mongodb+srv://...\r\n */\r\nimport { MongoClient } from 'mongodb';\r\n\r\nconst uri = process.env.MONGODB_URI;\r\nif (!uri) {\r\n  console.warn('MONGODB_URI not set - therapist dashboard will not persist');\r\n}\r\n\r\nlet client: MongoClient | null = null;\r\n\r\nexport async function getDb() {\r\n  if (!uri) throw new Error('MONGODB_URI not configured');\r\n  if (!client) client = new MongoClient(uri);\r\n  await client.connect();\r\n  return client.db();\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;;CAGC,GACD;;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,IAAI,CAAC,KAAK;IACR,QAAQ,IAAI,CAAC;AACf;AAEA,IAAI,SAA6B;AAE1B,eAAe;IACpB,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,IAAI,CAAC,QAAQ,SAAS,IAAI,6MAAW,CAAC;IACtC,MAAM,OAAO,OAAO;IACpB,OAAO,OAAO,EAAE;AAClB"}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/10099/OneDrive/Documents/phonetically/app/api/therapist/route.ts"],"sourcesContent":["/**\r\n * Therapist API - CRUD for user target sounds\r\n * GET: view target sounds for user\r\n * PATCH: add/remove target sounds, save to MongoDB\r\n */\r\nimport { NextRequest, NextResponse } from 'next/server';\r\nimport { getDb } from '../../../lib/mongodb';\r\n\r\nconst COLLECTION = 'user_profiles';\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const userId = request.nextUrl.searchParams.get('userId') || 'default';\r\n    const db = await getDb();\r\n    const doc = await db.collection(COLLECTION).findOne({ userId });\r\n    return NextResponse.json({\r\n      targetSounds: doc?.targetSounds ?? [],\r\n    });\r\n  } catch (e) {\r\n    if (String(e).includes('MONGODB_URI')) {\r\n      return NextResponse.json({ targetSounds: [] });\r\n    }\r\n    console.error(e);\r\n    return NextResponse.json(\r\n      { error: 'Failed to load' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport async function PATCH(request: NextRequest) {\r\n  try {\r\n    const body = await request.json();\r\n    const userId = body.userId || 'default';\r\n    const targetSounds = Array.isArray(body.targetSounds)\r\n      ? body.targetSounds\r\n      : [];\r\n\r\n    const db = await getDb();\r\n    await db.collection(COLLECTION).updateOne(\r\n      { userId },\r\n      {\r\n        $set: {\r\n          userId,\r\n          targetSounds,\r\n          updatedAt: new Date(),\r\n        },\r\n      },\r\n      { upsert: true }\r\n    );\r\n    return NextResponse.json({ success: true, targetSounds });\r\n  } catch (e) {\r\n    if (String(e).includes('MONGODB_URI')) {\r\n      return NextResponse.json(\r\n        { error: 'MONGODB_URI not configured' },\r\n        { status: 503 }\r\n      );\r\n    }\r\n    console.error(e);\r\n    return NextResponse.json(\r\n      { error: 'Failed to save' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;;;CAIC,GACD;AACA;;;AAEA,MAAM,aAAa;AAEZ,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,SAAS,QAAQ,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,aAAa;QAC7D,MAAM,KAAK,MAAM,IAAA,kKAAK;QACtB,MAAM,MAAM,MAAM,GAAG,UAAU,CAAC,YAAY,OAAO,CAAC;YAAE;QAAO;QAC7D,OAAO,yLAAY,CAAC,IAAI,CAAC;YACvB,cAAc,KAAK,gBAAgB,EAAE;QACvC;IACF,EAAE,OAAO,GAAG;QACV,IAAI,OAAO,GAAG,QAAQ,CAAC,gBAAgB;YACrC,OAAO,yLAAY,CAAC,IAAI,CAAC;gBAAE,cAAc,EAAE;YAAC;QAC9C;QACA,QAAQ,KAAK,CAAC;QACd,OAAO,yLAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAiB,GAC1B;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,MAAM,OAAoB;IAC9C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,SAAS,KAAK,MAAM,IAAI;QAC9B,MAAM,eAAe,MAAM,OAAO,CAAC,KAAK,YAAY,IAChD,KAAK,YAAY,GACjB,EAAE;QAEN,MAAM,KAAK,MAAM,IAAA,kKAAK;QACtB,MAAM,GAAG,UAAU,CAAC,YAAY,SAAS,CACvC;YAAE;QAAO,GACT;YACE,MAAM;gBACJ;gBACA;gBACA,WAAW,IAAI;YACjB;QACF,GACA;YAAE,QAAQ;QAAK;QAEjB,OAAO,yLAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM;QAAa;IACzD,EAAE,OAAO,GAAG;QACV,IAAI,OAAO,GAAG,QAAQ,CAAC,gBAAgB;YACrC,OAAO,yLAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA6B,GACtC;gBAAE,QAAQ;YAAI;QAElB;QACA,QAAQ,KAAK,CAAC;QACd,OAAO,yLAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAiB,GAC1B;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}