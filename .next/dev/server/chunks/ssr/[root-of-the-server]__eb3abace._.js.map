{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/10099/OneDrive/Documents/phonetically/app/dashboard/page.tsx"],"sourcesContent":["/**\r\n * Dashboard - personalized practice hub\r\n * Sections: Greeting, Recommended, Progress Overview, Recently Practiced, Phonetic Files\r\n */\r\n'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport Image from 'next/image';\r\n\r\nconst PHONETIC_FILES = [\r\n  { id: 'TH', title: 'TH', examples: 'think, thumb, the, that, this', sound: 'TH' },\r\n  { id: 'R', title: 'R', examples: 'red, run, car, rock, rain', sound: 'R' },\r\n  { id: 'S', title: 'S', examples: 'sun, sit, bus, sat, see', sound: 'S' },\r\n  { id: 'SH', title: 'SH', examples: 'ship, shoe, fish, wash, shop', sound: 'SH' },\r\n  { id: 'L', title: 'L', examples: 'lip, look, ball, light, love', sound: 'L' },\r\n  { id: 'Short-A', title: 'Short A', examples: 'cat, hat, bat, mat, sat', sound: 'Short A' },\r\n  { id: 'Short-I', title: 'Short I', examples: 'sit, hit, pig, big, win', sound: 'Short I' },\r\n  { id: 'Short-E', title: 'Short E', examples: 'red, bed, led, pet, net', sound: 'Short E' },\r\n  { id: 'F', title: 'F', examples: 'fun, fish, off, four, fine', sound: 'F' },\r\n  { id: 'V', title: 'V', examples: 'van, vine, love, have, very', sound: 'V' },\r\n];\r\n\r\nconst DAILY_GOAL = 12;\r\n\r\ntype ProgressData = {\r\n  attemptCount: number;\r\n  dailyAttemptCount?: number;\r\n  avgAccuracy: number;\r\n  soundsPracticedCount: number;\r\n  bySound: { sound: string; avgAccuracy: number; attemptCount: number }[];\r\n  bestSound: string | null;\r\n  worstSound: string | null;\r\n};\r\n\r\ntype RecentAttempt = { word: string; sound?: string; accuracy: number; createdAt: string };\r\n\r\ntype RecommendedData = { sound: string; reason: string; avgAccuracy: number | null };\r\n\r\nexport default function DashboardPage() {\r\n  const [userName, setUserName] = useState<string>('');\r\n  const [userId, setUserId] = useState('default');\r\n  const [progress, setProgress] = useState<ProgressData | null>(null);\r\n  const [recent, setRecent] = useState<RecentAttempt[]>([]);\r\n  const [recommended, setRecommended] = useState<RecommendedData | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    let uid = 'default';\r\n    let name = '';\r\n    try {\r\n      uid = localStorage.getItem('phona-user-id') || 'default';\r\n      name = localStorage.getItem('phona-user-name') || '';\r\n    } catch { /* ignore */ }\r\n    setUserId(uid);\r\n    setUserName(name);\r\n\r\n    Promise.all([\r\n      fetch(`/api/dashboard/progress?userId=${encodeURIComponent(uid)}`).then((r) => r.json()),\r\n      fetch(`/api/dashboard/recent?userId=${encodeURIComponent(uid)}`).then((r) => r.json()),\r\n      fetch(`/api/dashboard/recommended?userId=${encodeURIComponent(uid)}`).then((r) => r.json()),\r\n    ])\r\n      .then(([prog, rec, recm]) => {\r\n        setProgress(prog);\r\n        setRecent(rec);\r\n        setRecommended(recm);\r\n      })\r\n      .catch(console.error)\r\n      .finally(() => setLoading(false));\r\n  }, []);\r\n\r\n  const hasProgress = progress && progress.attemptCount > 0;\r\n  const greeting = userName.trim()\r\n    ? `Hello, ${userName.trim()}! Let's work on some phonetics.`\r\n    : \"Hello! Let's work on some phonetics.\";\r\n\r\n  return (\r\n    <div className=\"app-container\">\r\n      <div className=\"phona-header\">\r\n        <Link href=\"/\" className=\"phona-logo-link\" aria-label=\"Back to Home\">\r\n          <Image src=\"/phoneticallylogo.png\" alt=\"Phonetically\" width={96} height={96} className=\"phona-header-logo\" priority />\r\n        </Link>\r\n        <div />\r\n      </div>\r\n      <div className=\"app-content-scroll\">\r\n        <div className=\"content-wrapper max-w-2xl mx-auto w-full p-8\">\r\n        {/* 1) Greeting + subtitle */}\r\n        <h1 className=\"dashboard-title\">{greeting}</h1>\r\n        <p className=\"dashboard-subtitle\">\r\n          Pick a sound to practice and build your pronunciation skills.\r\n        </p>\r\n        <p className=\"dashboard-tip\">\r\n          Tip: Start with the sound you find hardest.\r\n        </p>\r\n\r\n        {/* Daily progress: X/12 - links to practice */}\r\n        <Link href=\"/practice\" className=\"dashboard-daily-progress glass-panel\">\r\n          <span className=\"dashboard-daily-label\">Daily progress</span>\r\n          <span className=\"dashboard-daily-value\">\r\n            {loading ? '—' : (progress?.dailyAttemptCount ?? 0)}/{DAILY_GOAL}\r\n          </span>\r\n        </Link>\r\n\r\n        {loading ? (\r\n          <p className=\"text-white/60\">Loading...</p>\r\n        ) : (\r\n          <>\r\n            {/* 2) Recommended for You */}\r\n            <div className=\"dashboard-recommended glass-panel\">\r\n              <h2 className=\"dashboard-section-title\">Recommended for you</h2>\r\n              {recommended ? (\r\n                <>\r\n                  <p className=\"dashboard-recommended-text\">\r\n                    {recommended.reason}\r\n                    {recommended.avgAccuracy != null && (\r\n                      <> (avg {recommended.avgAccuracy}%)</>\r\n                    )}\r\n                  </p>\r\n                  <Link\r\n                    href={`/practice?sound=${encodeURIComponent(recommended.sound)}`}\r\n                    className=\"dashboard-practice-btn dashboard-practice-btn-primary\"\r\n                    aria-label={`Practice ${recommended.sound}`}\r\n                  >\r\n                    Practice {recommended.sound}\r\n                  </Link>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <p className=\"dashboard-recommended-text\">Get started with Short A — a common sound to practice.</p>\r\n                  <Link\r\n                    href=\"/practice?sound=Short%20A\"\r\n                    className=\"dashboard-practice-btn dashboard-practice-btn-primary\"\r\n                    aria-label=\"Practice Short A\"\r\n                  >\r\n                    Practice Short A\r\n                  </Link>\r\n                </>\r\n              )}\r\n            </div>\r\n\r\n            {/* 3) Progress Overview */}\r\n            <h2 className=\"dashboard-section-title\">Progress Overview</h2>\r\n            {hasProgress && progress ? (\r\n              <>\r\n                <div className=\"dashboard-stats\">\r\n                  <div className=\"dashboard-stat-card glass-panel\">\r\n                    <div className=\"dashboard-stat-value\">{progress.avgAccuracy}%</div>\r\n                    <div className=\"dashboard-stat-label\">Avg Accuracy</div>\r\n                  </div>\r\n                  <div className=\"dashboard-stat-card glass-panel\">\r\n                    <div className=\"dashboard-stat-value\">{progress.attemptCount}</div>\r\n                    <div className=\"dashboard-stat-label\">Attempts</div>\r\n                  </div>\r\n                  <div className=\"dashboard-stat-card glass-panel\">\r\n                    <div className=\"dashboard-stat-value\">{progress.bestSound || '—'}</div>\r\n                    <div className=\"dashboard-stat-label\">Best Sound</div>\r\n                  </div>\r\n                  <div className=\"dashboard-stat-card glass-panel\">\r\n                    <div className=\"dashboard-stat-value\">{progress.worstSound || '—'}</div>\r\n                    <div className=\"dashboard-stat-label\">Needs Work</div>\r\n                  </div>\r\n                </div>\r\n                {progress.bySound.length > 0 && (\r\n                  <div className=\"dashboard-by-sound\">\r\n                    <h3 className=\"dashboard-by-sound-title\">By sound</h3>\r\n                    {progress.bySound.map((b) => (\r\n                      <div key={b.sound} className=\"dashboard-sound-row\">\r\n                        <div className=\"dashboard-sound-info\">\r\n                          <span className=\"dashboard-sound-name\">{b.sound}</span>\r\n                          <span className=\"dashboard-sound-meta\">{b.attemptCount} attempts, {b.avgAccuracy}%</span>\r\n                        </div>\r\n                        <div className=\"dashboard-progress-bar\">\r\n                          <div\r\n                            className=\"dashboard-progress-fill\"\r\n                            style={{ width: `${Math.min(100, b.avgAccuracy)}%` }}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </>\r\n            ) : (\r\n              <p className=\"dashboard-empty\">No progress yet — complete a practice session to see stats.</p>\r\n            )}\r\n\r\n            {/* 4) Recently Practiced */}\r\n            <h2 className=\"dashboard-section-title\">Recently Practiced</h2>\r\n            {recent.length > 0 ? (\r\n              <div className=\"dashboard-recent glass-panel\">\r\n                <div className=\"dashboard-recent-list\">\r\n                  {recent.map((a, i) => (\r\n                    <div key={i} className=\"dashboard-recent-item\">\r\n                      <span className=\"text-white/80\">{a.word}</span>\r\n                      <span className={a.accuracy >= 90 ? 'color-green' : 'color-amber'}>{a.accuracy}%</span>\r\n                      {a.createdAt && (\r\n                        <span className=\"dashboard-recent-date\">\r\n                          {new Date(a.createdAt).toLocaleDateString()}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <p className=\"dashboard-empty\">No recent attempts yet.</p>\r\n            )}\r\n\r\n            {/* 5) Phonetic Files */}\r\n            <h2 className=\"dashboard-section-title\">Phonetic files</h2>\r\n            <p className=\"dashboard-section-desc\">\r\n              Choose a sound to practice from the list below.\r\n            </p>\r\n            <div className=\"dashboard-cards\">\r\n              {PHONETIC_FILES.map((f) => (\r\n                <div key={f.id} className=\"dashboard-card glass-panel\">\r\n                  <div className=\"dashboard-card-content\">\r\n                    <div className=\"dashboard-card-text\">\r\n                      <div className=\"dashboard-card-title\">{f.title}</div>\r\n                      <div className=\"dashboard-card-examples\">{f.examples}</div>\r\n                    </div>\r\n                    <Link\r\n                      href={`/practice?sound=${encodeURIComponent(f.sound)}`}\r\n                      className=\"dashboard-practice-btn\"\r\n                      aria-label={`Practice ${f.sound}`}\r\n                    >\r\n                      Practice {f.sound}\r\n                    </Link>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </>\r\n        )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}