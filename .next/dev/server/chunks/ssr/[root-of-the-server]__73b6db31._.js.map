{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/10099/OneDrive/Documents/phonetically/lib/models/UserProfile.ts"],"sourcesContent":["/**\r\n * UserProfile model - target sounds for pronunciation practice\r\n * Schema: { userId, targetSounds: string[], updatedAt }\r\n */\r\nexport interface UserProfile {\r\n  _id?: string;\r\n  userId: string;\r\n  targetSounds: string[];\r\n  updatedAt: Date;\r\n}\r\n\r\nexport const PHONETIC_SOUNDS = [\r\n  '/r/',\r\n  '/s/',\r\n  '/th/',\r\n  '/sh/',\r\n  '/ch/',\r\n  '/l/',\r\n  '/f/',\r\n  '/v/',\r\n  'Short vowels (a, e, i, o, u)',\r\n  'Long vowels',\r\n  'R-controlled vowels',\r\n];\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AAQM,MAAM,kBAAkB;IAC7B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD"}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/10099/OneDrive/Documents/phonetically/app/practice/page.tsx"],"sourcesContent":["/**\r\n * Speech & Pronunciation Practice - Phona Read Aloud + target sounds\r\n * Types word/phrase for Phona TTS; select target sounds (saved to MongoDB)\r\n */\r\n'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport Link from 'next/link';\r\nimport Image from 'next/image';\r\nimport { Volume2 } from 'lucide-react';\r\nimport { PHONETIC_SOUNDS } from '../../lib/models/UserProfile';\r\n\r\nexport default function PracticePage() {\r\n  const [text, setText] = useState('');\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [targetSounds, setTargetSounds] = useState<string[]>([]);\r\n  const [soundsLoading, setSoundsLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetch('/api/therapist?userId=default')\r\n      .then((r) => r.json())\r\n      .then((d) => setTargetSounds(d.targetSounds || []))\r\n      .finally(() => setSoundsLoading(false));\r\n  }, []);\r\n\r\n  const toggleSound = (sound: string) => {\r\n    setTargetSounds((prev) =>\r\n      prev.includes(sound) ? prev.filter((s) => s !== sound) : [...prev, sound]\r\n    );\r\n  };\r\n\r\n  const saveTargetSounds = async () => {\r\n    setSaving(true);\r\n    try {\r\n      const res = await fetch('/api/therapist', {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ userId: 'default', targetSounds }),\r\n      });\r\n      if (!res.ok) throw new Error('Save failed');\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert('Failed to save. Is MONGODB_URI set?');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleReadAloud = async () => {\r\n    const trimmed = text.trim();\r\n    if (!trimmed) return;\r\n\r\n    setIsPlaying(true);\r\n    try {\r\n      const res = await fetch('/api/speak', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ text: trimmed }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const err = await res.json().catch(() => ({}));\r\n        throw new Error(err.error || 'API error');\r\n      }\r\n\r\n      const blob = await res.blob();\r\n      const url = URL.createObjectURL(blob);\r\n      const audio = new Audio(url);\r\n      await new Promise<void>((resolve, reject) => {\r\n        audio.onended = () => {\r\n          URL.revokeObjectURL(url);\r\n          resolve();\r\n        };\r\n        audio.onerror = () => {\r\n          URL.revokeObjectURL(url);\r\n          reject(new Error('Playback failed'));\r\n        };\r\n        audio.play();\r\n      });\r\n    } catch (e) {\r\n      console.error(e);\r\n      const utterance = new SpeechSynthesisUtterance(trimmed);\r\n      utterance.rate = 0.9;\r\n      await new Promise<void>((resolve) => {\r\n        utterance.onend = () => resolve();\r\n        speechSynthesis.speak(utterance);\r\n      });\r\n    } finally {\r\n      setIsPlaying(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"app-container\">\r\n      <div className=\"flex-1 flex flex-col p-6\">\r\n        <div className=\"content-wrapper max-w-2xl mx-auto w-full\">\r\n          <div className=\"flex items-center justify-between mb-12\">\r\n            <Link\r\n              href=\"/\"\r\n              className=\"text-white/60 hover:text-white transition-colors flex items-center gap-2\"\r\n            >\r\n              ‚Üê Back to Home\r\n            </Link>\r\n            <Image\r\n              src=\"/phoneticallylogo.png\"\r\n              alt=\"Phonetically\"\r\n              width={48}\r\n              height={48}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"text-center mb-8\">\r\n            <h1 className=\"text-4xl font-bold text-white mb-4\">\r\n              Speech & Pronunciation Practice\r\n            </h1>\r\n            <p className=\"text-white/70 text-lg mb-12 max-w-xl mx-auto\">\r\n              Type a word or phrase. Phona will read it aloud.\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"glass-panel p-8 mb-6\">\r\n            <label\r\n              className=\"text-white/70 text-sm block mb-3\"\r\n              htmlFor=\"practice-input\"\r\n            >\r\n              Enter a word or phrase\r\n            </label>\r\n            <input\r\n              id=\"practice-input\"\r\n              type=\"text\"\r\n              placeholder=\"e.g. Hello, phonetics\"\r\n              className=\"glass-input mb-6\"\r\n              style={{ padding: '14px 16px' }}\r\n              value={text}\r\n              onChange={(e) => setText(e.target.value)}\r\n              onKeyDown={(e) => e.key === 'Enter' && handleReadAloud()}\r\n            />\r\n            <button\r\n              onClick={handleReadAloud}\r\n              disabled={!text.trim() || isPlaying}\r\n              className=\"glass-button w-full p-5 text-lg font-semibold inline-flex items-center justify-center gap-3\"\r\n            >\r\n              <Volume2 size={28} />\r\n              {isPlaying ? 'Playing...' : 'Read Aloud'}\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"glass-panel p-6 mb-6\">\r\n            <h2 className=\"text-lg font-semibold text-white mb-4\">\r\n              Target sounds (practice plan)\r\n            </h2>\r\n            {soundsLoading ? (\r\n              <p className=\"text-white/70\">Loading...</p>\r\n            ) : (\r\n              <>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {PHONETIC_SOUNDS.map((sound) => (\r\n                    <button\r\n                      key={sound}\r\n                      type=\"button\"\r\n                      onClick={() => toggleSound(sound)}\r\n                      className={`sound-chip ${\r\n                        targetSounds.includes(sound) ? 'sound-chip-selected' : ''\r\n                      }`}\r\n                    >\r\n                      {sound}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n                <p className=\"text-white/50 text-sm mt-4\">\r\n                  Selected: {targetSounds.length}\r\n                </p>\r\n                <button\r\n                  onClick={saveTargetSounds}\r\n                  disabled={saving}\r\n                  className=\"glass-button px-6 py-3 font-semibold mt-4\"\r\n                >\r\n                  {saving ? 'Saving...' : 'Save to DB'}\r\n                </button>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}